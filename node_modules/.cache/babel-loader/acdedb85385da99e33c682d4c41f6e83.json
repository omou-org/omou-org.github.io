{"ast":null,"code":"import _objectSpread from \"/Users/danielhuang/Desktop/front-end/omou-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nvar _jsxFileName = \"/Users/danielhuang/Desktop/front-end/omou-frontend/src/components/Form/Form.js\";\nimport { connect } from \"react-redux\";\nimport { bindActionCreators } from \"redux\";\nimport * as registrationActions from \"../../actions/registrationActions\";\nimport React, { Component } from \"react\";\nimport { Prompt } from \"react-router\";\nimport { NavLink } from \"react-router-dom\"; // Material UI Imports\n\nimport Grid from \"@material-ui/core/Grid\";\nimport Button from \"@material-ui/core/Button\";\nimport Paper from \"@material-ui/core/Paper\";\nimport { Typography } from \"@material-ui/core\";\nimport Stepper from \"@material-ui/core/Stepper\";\nimport Step from \"@material-ui/core/Step\";\nimport StepLabel from \"@material-ui/core/StepLabel\";\nimport StepContent from \"@material-ui/core/StepContent\";\nimport TextField from \"@material-ui/core/TextField\";\nimport { InputValidation } from \"../FeatureViews/Registration/Validations\";\nimport Select from \"@material-ui/core/Select\";\nimport InputLabel from \"@material-ui/core/InputLabel\";\nimport FormControl from \"@material-ui/core/FormControl\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport Fab from \"@material-ui/core/Fab\";\nimport AddIcon from \"@material-ui/icons/Add\";\nimport RemoveIcon from \"@material-ui/icons/Clear\"; // Outside React Component\n\nimport SearchSelect from \"react-select\";\nimport BackButton from \"../BackButton.js\";\nimport Modal from \"@material-ui/core/Modal\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogActions from \"@material-ui/core/DialogActions\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport DialogContentText from \"@material-ui/core/DialogContentText\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nconst parseGender = {\n  \"M\": \"Male\",\n  \"F\": \"Female\",\n  \"U\": \"Do not disclose\"\n};\n\nclass Form extends Component {\n  constructor(props) {\n    super(props);\n\n    this.onBack = () => {\n      // clear session storage\n      sessionStorage.removeItem(\"form\");\n      this.props.registrationActions.resetSubmitStatus();\n    };\n\n    this.state = {\n      conditional: \"\",\n      nextSection: false,\n      activeStep: 0,\n      activeSection: \"\",\n      form: \"\",\n      submitPending: false,\n      preLoaded: false,\n      existingUser: false\n    };\n  }\n\n  componentWillMount() {\n    let prevState = JSON.parse(sessionStorage.getItem(\"form\") || null);\n    const formType = this.props.computedMatch.params.type;\n\n    if (this.props.computedMatch.params.edit === \"edit\") {\n      switch (formType) {\n        case \"student\":\n          {\n            const student = this.props.students[this.props.computedMatch.params.id];\n\n            if (student) {\n              const parent = this.props.parents[student.parent_id];\n              prevState = _objectSpread({}, this.state, {\n                \"Basic Information\": {\n                  \"Student First Name\": student.first_name,\n                  \"Student Last Name\": student.last_name,\n                  \"Gender\": parseGender[student.gender],\n                  \"Grade\": student.grade,\n                  \"Age\": student.age,\n                  \"School\": student.school,\n                  \"Student Email\": student.email,\n                  \"Student Phone Number\": student.phone_number\n                },\n                \"Parent Information\": {\n                  \"Select Parent\": {\n                    value: parent.user_id,\n                    label: \"\".concat(parent.user_id, \": \").concat(parent.name, \" - \").concat(parent.email)\n                  },\n                  \"Parent First Name\": parent.first_name,\n                  \"Parent Last Name\": parent.last_name,\n                  \"Gender\": parseGender[parent.gender],\n                  \"Parent Email\": parent.email,\n                  \"Address\": parent.address,\n                  \"City\": parent.city,\n                  \"State\": parent.state,\n                  \"Zip Code\": parent.zipcode,\n                  \"Relationship to Student\": parent.relationship,\n                  \"Phone Number\": parent.phone_number\n                },\n                \"Basic Information_validated\": {\n                  \"Student First Name\": true,\n                  \"Student Last Name\": true,\n                  \"Gender\": true,\n                  \"Grade\": true,\n                  \"Age\": true,\n                  \"School\": true,\n                  \"Student Email\": true,\n                  \"Student Phone Number\": true\n                },\n                \"Parent Information_validated\": {\n                  \"Parent First Name\": true,\n                  \"Parent Last Name\": true,\n                  \"Gender\": true,\n                  \"Parent Email\": true,\n                  \"Address\": true,\n                  \"City\": true,\n                  \"State\": true,\n                  \"Zip Code\": true,\n                  \"Relationship to Student\": true,\n                  \"Phone Number\": true\n                },\n                \"form\": formType,\n                \"activeSection\": \"Basic Information\",\n                \"nextSection\": true,\n                \"preLoaded\": true\n              });\n            }\n\n            break;\n          }\n\n        case \"instructor\":\n          {\n            const instructor = this.props.instructors[this.props.computedMatch.params.id];\n\n            if (instructor) {\n              prevState = _objectSpread({}, this.state, {\n                \"Basic Information\": {\n                  \"First Name\": instructor.first_name,\n                  \"Last Name\": instructor.last_name,\n                  \"E-Mail\": instructor.email,\n                  \"Phone Number\": instructor.phone_number,\n                  \"Gender\": parseGender[instructor.gender],\n                  \"Address\": instructor.address,\n                  \"City\": instructor.city,\n                  \"Zip Code\": instructor.zipcode,\n                  \"State\": instructor.state,\n                  \"Date of Birth\": instructor.birth_date\n                },\n                \"Education\": {\n                  \"College\": \"\",\n                  \"Degree(s)\": \"\",\n                  \"Minor(s)\": \"\"\n                },\n                \"Experience\": {\n                  \"Subject(s) Tutor Can Teach\": \"\",\n                  \"Specialties\": \"\",\n                  \"Background\": \"\",\n                  \"Notes\": \"\"\n                },\n                \"Basic Information_validated\": {\n                  \"First Name\": true,\n                  \"Last Name\": true,\n                  \"E-Mail\": true,\n                  \"Phone Number\": true,\n                  \"Gender\": true,\n                  \"Address\": true,\n                  \"City\": true,\n                  \"Zip Code\": true,\n                  \"State\": true,\n                  \"Date of Birth\": true\n                },\n                \"Education_validated\": {\n                  \"College\": true,\n                  \"Degree(s)\": true,\n                  \"Minor(s)\": true\n                },\n                \"Experience_validated\": {\n                  \"Subject(s) Tutor Can Teach\": true,\n                  \"Specialties\": true,\n                  \"Background\": true,\n                  \"Notes\": true\n                },\n                \"form\": formType,\n                \"activeSection\": \"Basic Information\",\n                \"nextSection\": true,\n                \"preLoaded\": true\n              });\n            }\n\n            break;\n          }\n\n        default:\n          console.warn(\"Invalid form type!\");\n      }\n    }\n\n    if (!prevState || formType !== prevState.form || prevState[\"submitPending\"] || this.props.computedMatch.params.id && this.props.computedMatch.params.edit !== \"edit\") {\n      if (this.props.registrationForm[formType]) {\n        this.setState(oldState => {\n          const formContents = JSON.parse(JSON.stringify(this.props.registrationForm[formType]));\n\n          let NewState = _objectSpread({}, oldState, {\n            activeSection: formContents.section_titles[0],\n            form: formType\n          });\n\n          let course = \"\";\n\n          if (this.props.computedMatch.params.id) {\n            course = decodeURIComponent(this.props.computedMatch.params.id);\n            course = Object.keys(this.props.courses).find(courseID => this.props.courses[courseID].title === course);\n            course = this.props.courses[course];\n\n            if (course) {\n              // convert it to a format that onselectChange can use\n              course = {\n                value: \"\".concat(course.course_id, \": \").concat(course.title),\n                label: \"\".concat(course.course_id, \": \").concat(course.title)\n              };\n            }\n          }\n\n          formContents.section_titles.forEach(title => {\n            // create blank fields based on form type\n            NewState[title] = {}; // set a value for every non-conditional field (object)\n\n            if (Array.isArray(formContents[title])) {\n              formContents[title].forEach(({\n                field,\n                type,\n                options\n              }) => {\n                switch (type) {\n                  case \"course\":\n                    NewState[title][field] = course;\n                    break;\n\n                  case \"select\":\n                    NewState[title][field] = options[0];\n                    break;\n\n                  case \"student\":\n                    NewState[title][field] = \"\";\n                    break;\n\n                  default:\n                    NewState[title][field] = null;\n                }\n              });\n            } // create validated state for each field\n\n\n            NewState[\"\".concat(title, \"_validated\")] = {};\n\n            if (Array.isArray(formContents[title])) {\n              formContents[title].forEach(field => {\n                NewState[\"\".concat(title, \"_validated\")][field.name] = true;\n              });\n            }\n          });\n          return NewState;\n        }, () => {\n          this.setState({\n            nextSection: this.validateSection()\n          });\n        });\n      }\n    } else if (prevState && !prevState[\"submitPending\"]) {\n      this.setState(prevState);\n    }\n  }\n\n  getFormObject() {\n    return this.props.registrationForm[this.state.form];\n  }\n\n  getActiveSection() {\n    const section = this.getFormObject()[this.state.activeSection];\n\n    if (Array.isArray(section)) {\n      return section;\n    } else {\n      return section[this.state.conditional];\n    }\n  }\n\n  getStepContent(step, formType) {\n    return this.props.registrationForm[formType][step];\n  }\n\n  validateSection() {\n    const currSectionTitle = this.getFormObject().section_titles[this.state.activeStep];\n    return this.getActiveSection().filter(({\n      required\n    }) => required).every(({\n      name\n    }) => this.state[currSectionTitle][name]) && Object.values(this.state[\"\".concat(currSectionTitle, \"_validated\")]).every(valid => valid);\n  }\n\n  getConditionalFieldFromCurrentSection() {\n    let nextSectionInput = false;\n    const currSectionTitle = this.state.activeSection; // Get input from the conditional field\n\n    if (Array.isArray(this.getFormObject()[currSectionTitle])) {\n      this.getFormObject()[currSectionTitle].some(field => {\n        if (field.conditional) {\n          nextSectionInput = this.state[currSectionTitle][field.name];\n          return true;\n        } else {\n          return false;\n        }\n      });\n    }\n\n    return nextSectionInput;\n  } // Progresses to next section in registration form\n\n\n  handleNext() {\n    const currSectionTitle = this.getFormObject().section_titles[this.state.activeStep];\n    let section = this.props.registrationForm[this.state.form][this.state.activeSection];\n\n    if (!Array.isArray(section)) {\n      section = section[this.state.conditional];\n    }\n\n    section.forEach(field => {\n      this.validateField(currSectionTitle, field, this.state[currSectionTitle][field.name]);\n    });\n    this.setState(oldState => {\n      if (this.validateSection()) {\n        if (oldState.activeStep === this.getFormObject().section_titles.length - 1) {\n          if (!oldState.submitPending) {\n            if (this.props.computedMatch.params.edit === \"edit\") {\n              this.props.registrationActions.submitForm(this.state, this.props.computedMatch.params.id);\n            } else {\n              this.props.registrationActions.submitForm(this.state);\n            }\n          }\n\n          return {\n            submitPending: true\n          };\n        } else {\n          const conditionalField = this.getConditionalFieldFromCurrentSection(),\n                nextActiveStep = oldState.activeStep + 1,\n                nextActiveSection = this.getFormObject().section_titles[nextActiveStep];\n          let newState = {\n            activeStep: nextActiveStep,\n            activeSection: nextActiveSection,\n            conditional: conditionalField ? conditionalField : oldState.conditional,\n            nextSection: false\n          };\n\n          if (conditionalField) {\n            let formContents = this.getFormObject(),\n                title = nextActiveSection; // create blank fields based on form type\n\n            newState[title] = {};\n            formContents[nextActiveSection][conditionalField].forEach(field => {\n              newState[title][field.name] = \"\";\n            }); // create validated state for each field\n\n            newState[\"\".concat(title, \"_validated\")] = {};\n            formContents[nextActiveSection][conditionalField].forEach(field => {\n              newState[\"\".concat(title, \"_validated\")][field.name] = true;\n            });\n          }\n\n          return newState;\n        }\n      } else {\n        return {};\n      }\n    }, () => {\n      this.setState({\n        nextSection: this.validateSection()\n      });\n    });\n  } // Regresses to previous section in registration form\n\n\n  handleBack() {\n    this.setState(oldState => {\n      if (oldState.activeStep !== 0 && oldState.activeSection) {\n        return {\n          activeStep: oldState.activeStep - 1,\n          activeSection: this.getFormObject().section_titles[oldState.activeStep - 1]\n        };\n      } else {\n        return {};\n      }\n    }, () => {\n      this.setState({\n        nextSection: this.validateSection()\n      });\n    });\n  }\n\n  handleReset() {\n    this.setState({\n      activeStep: 0\n    });\n  }\n\n  handleFieldUpdate(sectionTitle, field, fieldValue) {\n    this.setState(oldState => {\n      oldState[sectionTitle][field.name] = fieldValue;\n      return oldState;\n    });\n  }\n\n  validateField(sectionTitle, field, fieldValue) {\n    this.setState(oldState => {\n      if (!fieldValue) {\n        // if empty field\n        oldState[\"\".concat(sectionTitle, \"_validated\")][field.name] = !field.required;\n      } else if (InputValidation(fieldValue, field.type)) {\n        // if valid input\n        let isValid = true;\n\n        if (field.type === \"number\") {\n          // parse if number\n          oldState[sectionTitle][field.name] = parseInt(fieldValue, 10);\n        } else if (field.type === \"email\") {\n          let emails = [];\n\n          if (field.field === \"Student Email\") {\n            emails = Object.values(this.props.students).map(({\n              email\n            }) => email);\n          } // validate that email doesn't exist in database already\n\n\n          isValid = !emails.includes(fieldValue) || this.state.preLoaded;\n\n          if (!isValid) {\n            oldState.existingUser = true;\n          }\n        }\n\n        oldState[\"\".concat(sectionTitle, \"_validated\")][field.name] = isValid;\n      } else {\n        oldState[\"\".concat(sectionTitle, \"_validated\")][field.name] = false;\n      }\n\n      return oldState;\n    }, () => {\n      this.setState({\n        nextSection: this.validateSection()\n      }, () => {\n        sessionStorage.setItem(\"form\", JSON.stringify(this.state));\n      });\n    });\n  }\n\n  onSelectChange(value, label, field) {\n    if (field.type === \"select parent\") {\n      if (value) {\n        this.setState(OldState => {\n          let NewState = OldState;\n          const selectedParentID = value.value;\n          const parent = this.props.parents[selectedParentID];\n          NewState[label] = {\n            \"Select Parent\": {\n              value: selectedParentID,\n              label: \"\".concat(selectedParentID, \": \").concat(parent.name, \" - \").concat(parent.email)\n            },\n            \"Parent First Name\": parent.first_name,\n            \"Parent Last Name\": parent.last_name,\n            \"Gender\": parent.gender,\n            \"Parent Email\": parent.email,\n            \"Address\": parent.address,\n            \"City\": parent.city,\n            \"State\": parent.state,\n            \"Zip Code\": parent.zipcode,\n            \"Relationship to Student\": parent.relationship,\n            \"Parent Phone Number\": parent.phone_number,\n            \"user_id\": selectedParentID\n          };\n          Object.keys(NewState[label]).forEach(key => {\n            NewState[\"\".concat(label, \"_validated\")][key] = true;\n          });\n          return NewState;\n        }, () => {\n          this.validateSection();\n          this.setState({\n            nextSection: true\n          });\n        });\n      } else {\n        this.setState(OldState => {\n          let NewState = OldState;\n          NewState[label] = {\n            \"Select Parent\": null,\n            \"Parent First Name\": \"\",\n            \"Parent Last Name\": \"\",\n            \"Gender\": \"\",\n            \"Parent Email\": \"\",\n            \"Address\": \"\",\n            \"City\": \"\",\n            \"State\": \"\",\n            \"Zip Code\": \"\",\n            \"Relationship to Student\": \"\",\n            \"Parent Phone Number\": \"\",\n            \"user_id\": \"\"\n          };\n          Object.keys(NewState[label]).forEach(key => {\n            NewState[\"\".concat(label, \"_validated\")][key] = true;\n          });\n          NewState.nextSection = false;\n          return NewState;\n        });\n      }\n    } else {\n      this.setState(OldState => {\n        let NewState = OldState;\n        NewState[label][field.name] = value;\n        return NewState;\n      }, () => {\n        this.validateField(this.state.activeSection, field, value);\n      });\n    }\n  } // removes duplicates with arr1 from arr2 from search select field\n\n\n  removeDuplicates(arr1, arr2) {\n    let stringValue, stringOtherValue;\n    arr1.forEach(value => {\n      if (value) {\n        stringValue = value.value;\n      } else {\n        stringValue = \"\";\n      }\n\n      arr2.forEach((otherValue, j) => {\n        if (otherValue) {\n          stringOtherValue = otherValue.value;\n        } else {\n          stringOtherValue = \"\";\n        }\n\n        if (stringValue === stringOtherValue) {\n          arr2[j] = \"1\";\n        }\n      });\n    });\n    let uniqueVals = [...new Set(arr2)],\n        indexOfString = -1;\n    uniqueVals.forEach((value, i) => {\n      if (typeof value === \"string\") {\n        indexOfString = i;\n      }\n    });\n\n    if (indexOfString > -1) {\n      uniqueVals.splice(indexOfString, 1);\n    }\n\n    return uniqueVals;\n  }\n\n  renderField(field, label, fieldIndex) {\n    let fieldTitle = field.name;\n\n    switch (field.type) {\n      case \"select\":\n        return React.createElement(FormControl, {\n          className: \"form-control\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 529\n          },\n          __self: this\n        }, React.createElement(InputLabel, {\n          htmlFor: fieldTitle,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 530\n          },\n          __self: this\n        }, fieldTitle), React.createElement(Select, {\n          displayEmpty: false,\n          value: this.state[label][fieldTitle],\n          onChange: ({\n            target\n          }) => {\n            this.onSelectChange(target.value, label, field);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 531\n          },\n          __self: this\n        }, field.options.map(option => {\n          return React.createElement(MenuItem, {\n            value: option,\n            key: option,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 539\n            },\n            __self: this\n          }, React.createElement(\"em\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 540\n            },\n            __self: this\n          }, option));\n        })));\n\n      case \"course\":\n        {\n          let courseList = Object.keys(this.props.courses).filter(courseID => this.props.courses[courseID].capacity > this.props.courses[courseID].filled).map(courseID => ({\n            value: courseID,\n            label: \"\".concat(courseID, \": \").concat(this.props.courses[courseID].title)\n          })); // remove preselected courses\n\n          courseList = this.removeDuplicates(Object.values(this.state[label]), courseList); // count # of course fields in current section\n\n          const fieldCount = this.getActiveSection().reduce((total, {\n            type\n          }) => total + (type === \"course\"), 0);\n          return React.createElement(\"div\", {\n            style: {\n              width: \"inherit\"\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 561\n            },\n            __self: this\n          }, React.createElement(Grid, {\n            container: true,\n            className: \"student-align\",\n            spacing: 2000,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 562\n            },\n            __self: this\n          }, React.createElement(SearchSelect, {\n            value: this.state[label][fieldTitle],\n            onChange: value => {\n              this.onSelectChange(value, label, field);\n            },\n            options: courseList,\n            className: \"search-options\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 563\n            },\n            __self: this\n          }), fieldCount > 1 && React.createElement(RemoveIcon, {\n            color: \"primary\",\n            \"aria-label\": \"Add\",\n            variant: \"extended\",\n            className: \"button-remove-student\",\n            onClick: event => {\n              event.preventDefault(); // deletes answer field from state\n\n              this.removeField(fieldIndex);\n              this.forceUpdate();\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 572\n            },\n            __self: this\n          })));\n        }\n\n      case \"student\":\n        {\n          let studentList = Object.values(this.props.students).map(({\n            user_id,\n            name,\n            email\n          }) => ({\n            value: user_id,\n            label: \"\".concat(name, \" - \").concat(email)\n          }));\n          studentList = this.removeDuplicates(Object.values(this.state[label]), studentList); // count # of course fields in current section\n\n          const studentCount = this.getActiveSection().reduce((total, {\n            type\n          }) => total + (type === \"student\"), 0);\n          return React.createElement(\"div\", {\n            style: {\n              width: \"inherit\"\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 600\n            },\n            __self: this\n          }, React.createElement(Grid, {\n            container: true,\n            className: \"student-align\",\n            spacing: 2000,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 601\n            },\n            __self: this\n          }, React.createElement(SearchSelect, {\n            value: this.state[label][fieldTitle] ? this.state[label][fieldTitle] : \"\",\n            onChange: value => {\n              this.onSelectChange(value, label, field);\n            },\n            options: studentList,\n            className: \"search-options\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 602\n            },\n            __self: this\n          }), studentCount > 1 && React.createElement(RemoveIcon, {\n            color: \"primary\",\n            \"aria-label\": \"Add\",\n            variant: \"extended\",\n            className: \"button-remove-student\",\n            onClick: event => {\n              event.preventDefault(); // deletes answer field\n\n              this.removeField(fieldIndex);\n              this.forceUpdate();\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 611\n            },\n            __self: this\n          })));\n        }\n\n      case \"instructor\":\n        {\n          let instructorList = this.props.instructors;\n          instructorList = Object.values(instructorList).map(({\n            user_id,\n            name,\n            email\n          }) => ({\n            value: user_id,\n            label: \"\".concat(name, \" - \").concat(email)\n          }));\n          instructorList = this.removeDuplicates(Object.values(this.state[label]), instructorList);\n          return React.createElement(\"div\", {\n            style: {\n              width: \"inherit\"\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 633\n            },\n            __self: this\n          }, React.createElement(Grid, {\n            container: true,\n            className: \"student-align\",\n            spacing: 2000,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 634\n            },\n            __self: this\n          }, React.createElement(SearchSelect, {\n            value: this.state[label][fieldTitle] ? this.state[label][fieldTitle] : \"\",\n            onChange: value => {\n              this.onSelectChange(value, label, field);\n            },\n            options: instructorList,\n            className: \"search-options\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 635\n            },\n            __self: this\n          })));\n        }\n\n      case \"select parent\":\n        {\n          const currParentList = Object.values(this.props.parents).map(({\n            user_id,\n            name,\n            email\n          }) => ({\n            value: user_id,\n            label: \"\".concat(name, \" - \").concat(email)\n          }));\n          return React.createElement(SearchSelect, {\n            className: \"search-options\",\n            isClearable: true,\n            onChange: value => {\n              this.onSelectChange(value, label, field);\n            },\n            value: this.state[label][fieldTitle],\n            options: currParentList,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 652\n            },\n            __self: this\n          });\n        }\n\n      default:\n        return React.createElement(TextField, {\n          label: field.name,\n          multiline: field.multiline,\n          margin: \"normal\",\n          value: this.state[label][field.name],\n          error: !this.state[label + \"_validated\"][field.name],\n          helperText: !this.state[label + \"_validated\"][field.name] ? field.name + \" invalid\" : \"\",\n          type: field.type === \"number\" ? \"Number\" : \"text\",\n          required: field.required,\n          fullWidth: field.full,\n          onChange: e => {\n            e.preventDefault();\n            this.handleFieldUpdate.bind(this)(label, field, e.target.value);\n          },\n          onBlur: e => {\n            e.preventDefault();\n            this.validateField.bind(this)(label, field, e.target.value);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 664\n          },\n          __self: this\n        });\n    }\n  }\n\n  addField(field, fieldIndex) {\n    const currentForm = this.getFormObject();\n    let param = [this.state.form, this.state.activeSection, fieldIndex];\n\n    if (!Array.isArray(currentForm[this.state.activeSection])) {\n      param.splice(2, 0, this.state.conditional);\n    }\n\n    this.props.registrationActions.addField(param);\n    this.setState(prevState => {\n      // number of fields of the same type as the current field\n      const form = prevState.form,\n            activeSection = prevState.activeSection,\n            conditional = prevState.conditional;\n      let section = this.props.registrationForm[form][activeSection];\n\n      if (!Array.isArray(section)) {\n        section = section[conditional];\n      }\n\n      const numSameTypeFields = section.reduce((count, otherField) => count + (field === otherField.field), 0);\n\n      if (Array.isArray(prevState[activeSection])) {\n        prevState[activeSection][\"\".concat(field, \" \").concat(numSameTypeFields)] = null;\n        prevState[\"\".concat(activeSection, \"_validated\")][\"\".concat(field, \" \").concat(numSameTypeFields)] = true;\n      } else {\n        prevState[activeSection][\"\".concat(field, \" \").concat(numSameTypeFields)] = null;\n        prevState[\"\".concat(activeSection, \"_validated\")][\"\".concat(field, \" \").concat(numSameTypeFields)] = true;\n      }\n\n      return prevState;\n    }, () => {\n      sessionStorage.setItem(\"form\", JSON.stringify(this.state));\n    }); // for some reason it isn't rerendering automatically\n  }\n\n  removeField(fieldIndex) {\n    this.setState(prevState => {\n      const currentSectionFields = prevState[prevState[\"activeSection\"]];\n      const currentSectionValidationFields = prevState[\"\".concat(prevState[\"activeSection\"], \"_validated\")];\n      let baseName;\n      let newSectionFields = {};\n      let newSectionValidationFields = {};\n      let index = 0;\n      let hasNotRemoved = true;\n      Object.entries(currentSectionFields).forEach(([origFieldKey, fieldValue]) => {\n        if (index === 0 && hasNotRemoved) {\n          baseName = origFieldKey;\n        }\n\n        if (index === fieldIndex && hasNotRemoved) {\n          hasNotRemoved = false;\n          return;\n        }\n\n        let newFieldName = index === 0 ? baseName : \"\".concat(baseName, \" \").concat(index + 1);\n        newSectionFields[newFieldName] = fieldValue;\n        newSectionValidationFields[newFieldName] = currentSectionValidationFields[origFieldKey];\n        index++;\n      });\n      prevState[prevState[\"activeSection\"]] = newSectionFields;\n      prevState[\"\".concat(prevState[\"activeSection\"], \"_validated\")] = newSectionValidationFields; //save to session Storage\n\n      sessionStorage.setItem(\"form\", JSON.stringify(this.state));\n      return prevState;\n    }, () => {\n      //delete field from redux store\n      let param = [this.state.form, this.state.activeSection];\n      this.props.registrationActions.removeField(param, fieldIndex, this.state.conditional);\n      this.forceUpdate();\n    });\n    this.forceUpdate();\n  }\n\n  renderForm() {\n    let _this$state = this.state,\n        activeStep = _this$state.activeStep,\n        nextSection = _this$state.nextSection,\n        currentForm = this.props.registrationForm[this.state.form],\n        steps = currentForm.section_titles;\n    let section = this.getActiveSection();\n    return React.createElement(Stepper, {\n      activeStep: activeStep,\n      orientation: \"vertical\",\n      className: \"form-section\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 760\n      },\n      __self: this\n    }, steps.map((label, i) => React.createElement(Step, {\n      key: label,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 766\n      },\n      __self: this\n    }, React.createElement(StepLabel, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 767\n      },\n      __self: this\n    }, label, activeStep > i && Object.entries(this.state[label]).map(([field, value]) => {\n      if (!value) {\n        return null;\n      }\n\n      if (value && value.hasOwnProperty(\"label\")) {\n        value = value.label;\n      }\n\n      return React.createElement(\"div\", {\n        key: field,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 779\n        },\n        __self: this\n      }, React.createElement(Typography, {\n        className: \"field-title\",\n        align: \"left\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 780\n        },\n        __self: this\n      }, field, \": \", value));\n    })), React.createElement(StepContent, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 788\n      },\n      __self: this\n    }, section.map((field, j) => {\n      // number of fields of the same type as the current field\n      const numSameTypeFields = section.reduce((count, otherField) => field.field === otherField.field ? count + 1 : count, 0),\n            reversedSection = [...section].reverse(),\n            lastFieldOfType = reversedSection.find(otherField => otherField.field === field.field);\n      return React.createElement(\"div\", {\n        key: j,\n        className: \"fields-wrapper\",\n        style: {},\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 796\n        },\n        __self: this\n      }, React.createElement(Grid, {\n        container: true,\n        className: \"student-align\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 797\n        },\n        __self: this\n      }, label === this.state.activeSection ? this.renderField(field, label, j) : \"\"), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 800\n        },\n        __self: this\n      }), !this.props.computedMatch.params.course && numSameTypeFields < field.field_limit && field === lastFieldOfType && React.createElement(Fab, {\n        color: \"primary\",\n        \"aria-label\": \"Add\",\n        variant: \"extended\",\n        className: \"button add-student\",\n        onClick: event => {\n          event.preventDefault();\n          this.addField(field.field, j);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 804\n        },\n        __self: this\n      }, React.createElement(AddIcon, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 810\n        },\n        __self: this\n      }), \"Add \", field.field));\n    }), React.createElement(\"div\", {\n      className: \"controls\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 819\n      },\n      __self: this\n    }, React.createElement(Button, {\n      disabled: activeStep === 0,\n      color: \"secondary\",\n      onClick: event => {\n        event.preventDefault();\n        this.handleBack();\n      },\n      className: \"button \".concat(activeStep === 0 ? \"hide\" : \"\"),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 820\n      },\n      __self: this\n    }, \"Back\"), React.createElement(Button, {\n      variant: \"contained\",\n      color: \"primary\",\n      disabled: !nextSection,\n      onClick: event => {\n        event.preventDefault();\n        this.handleNext();\n      },\n      className: \"button primary\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 830\n      },\n      __self: this\n    }, activeStep === steps.length - 1 ? this.props.submitPending ? \"Submitting\" : \"Submit\" : \"Next\"))))));\n  } // view after a submitted form\n\n\n  renderSubmitted() {\n    const currentForm = this.props.registrationForm[this.state.form];\n    const steps = currentForm.section_titles;\n    sessionStorage.removeItem(\"form\");\n    return React.createElement(\"div\", {\n      style: {\n        margin: \"2%\",\n        padding: \"5px\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 856\n      },\n      __self: this\n    }, React.createElement(Typography, {\n      align: \"left\",\n      style: {\n        fontSize: \"24px\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 860\n      },\n      __self: this\n    }, \"You have successfully registered!\"), React.createElement(Typography, {\n      align: \"left\",\n      style: {\n        fontSize: \"14px\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 863\n      },\n      __self: this\n    }, \"An email will be sent to you to confirm your registration\"), React.createElement(Button, {\n      align: \"left\",\n      component: NavLink,\n      to: \"/registration\",\n      onClick: () => {\n        this.props.registrationActions.resetSubmitStatus();\n      },\n      style: {\n        margin: \"20px\"\n      },\n      className: \"button\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 866\n      },\n      __self: this\n    }, \"Back to Registration\"), React.createElement(\"div\", {\n      className: \"confirmation-copy\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 875\n      },\n      __self: this\n    }, React.createElement(Typography, {\n      className: \"title\",\n      align: \"left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 876\n      },\n      __self: this\n    }, \"Confirmation Copy\"), steps.map(sectionTitle => React.createElement(\"div\", {\n      key: sectionTitle,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 879\n      },\n      __self: this\n    }, React.createElement(Typography, {\n      className: \"section-title\",\n      align: \"left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 880\n      },\n      __self: this\n    }, sectionTitle), this.getActiveSection().map(({\n      field,\n      type\n    }) => {\n      let fieldVal = this.state[sectionTitle][field];\n\n      if (fieldVal && fieldVal.hasOwnProperty(\"value\")) {\n        fieldVal = fieldVal.value;\n\n        if (type === \"select parent\" && typeof fieldVal === \"number\") {\n          fieldVal = this.props.parents[fieldVal].first_name;\n        }\n      }\n\n      return React.createElement(\"div\", {\n        key: field,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 896\n        },\n        __self: this\n      }, React.createElement(Typography, {\n        className: \"field-title\",\n        align: \"left\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 897\n        },\n        __self: this\n      }, field || \"\"), React.createElement(Typography, {\n        className: \"field-value\",\n        align: \"left\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 900\n        },\n        __self: this\n      }, fieldVal || \"N/A\"));\n    })))));\n  }\n\n  renderTitle(id, type) {\n    switch (type) {\n      case \"course\":\n        return id ? decodeURIComponent(id) : \"\";\n\n      case \"student\":\n        {\n          const student = this.props.students[id];\n          return student ? student.name : \"\";\n        }\n\n      default:\n        return \"\";\n    }\n  }\n\n  render() {\n    return React.createElement(Grid, {\n      container: true,\n      className: \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 930\n      },\n      __self: this\n    }, this.state.submitPending ? \"\" : React.createElement(Prompt, {\n      message: \"Are you sure you want to leave?\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 932\n      },\n      __self: this\n    }), React.createElement(Grid, {\n      item: true,\n      xs: 12,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 933\n      },\n      __self: this\n    }, React.createElement(Paper, {\n      className: \"registration-form paper\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 934\n      },\n      __self: this\n    }, React.createElement(BackButton, {\n      warn: true,\n      onBack: this.onBack,\n      alertMessage: \"Do you want to save your changes?\",\n      alertConfirmText: \"Yes, save changes\",\n      confirmAction: \"saveForm\",\n      alertDenyText: \"No, don't save changes\",\n      denyAction: \"default\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 935\n      },\n      __self: this\n    }), React.createElement(Typography, {\n      className: \"heading\",\n      align: \"left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 944\n      },\n      __self: this\n    }, this.renderTitle(this.props.computedMatch.params.id, this.state.form), \" \", this.props.computedMatch.params.type, \" Registration\"), this.props.submitStatus !== \"success\" ? this.props.registrationForm[this.state.form] ? this.renderForm.bind(this)() : React.createElement(Typography, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 951\n      },\n      __self: this\n    }, \"Sorry! The form is unavailable.\") : this.renderSubmitted(), React.createElement(Modal, {\n      \"aria-labelledby\": \"simple-modal-title\",\n      \"aria-describedby\": \"simple-modal-description\",\n      open: this.state.existingUser,\n      onClick: e => {\n        e.preventDefault();\n        this.setState({\n          existingUser: false\n        });\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 956\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"existing-user-popup\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 964\n      },\n      __self: this\n    }, React.createElement(Typography, {\n      variant: \"h6\",\n      id: \"modal-title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 965\n      },\n      __self: this\n    }, \"The user you are entering already exists in the database! Please enter a new email, and check for spelling.\"), React.createElement(Button, {\n      onClick: e => {\n        e.preventDefault();\n        this.setState({\n          existingUser: false\n        });\n      },\n      color: \"primary\",\n      className: \"button primary\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 968\n      },\n      __self: this\n    }, \"I will enter a new email\"))), React.createElement(Dialog, {\n      open: this.props.submitStatus === \"fail\",\n      onClose: () => {\n        this.props.registrationActions.resetSubmitStatus();\n        this.setState({\n          \"submitPending\": false\n        }, () => {\n          sessionStorage.setItem(\"form\", JSON.stringify(this.state));\n        });\n      },\n      \"aria-labelledby\": \"alert-dialog-title\",\n      \"aria-describedby\": \"alert-dialog-description\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 980\n      },\n      __self: this\n    }, React.createElement(DialogTitle, {\n      id: \"alert-dialog-title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 992\n      },\n      __self: this\n    }, \"Failed to Submit\"), React.createElement(DialogContent, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 993\n      },\n      __self: this\n    }, React.createElement(DialogContentText, {\n      id: \"alert-dialog-description\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 994\n      },\n      __self: this\n    }, \"There was an error submitting the form. Check all fields and try again.\")), React.createElement(DialogActions, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 998\n      },\n      __self: this\n    }, React.createElement(Button, {\n      onClick: () => {\n        this.props.registrationActions.resetSubmitStatus();\n        this.setState({\n          \"submitPending\": false\n        }, () => {\n          sessionStorage.setItem(\"form\", JSON.stringify(this.state));\n        });\n      },\n      color: \"primary\",\n      autoFocus: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 999\n      },\n      __self: this\n    }, \"Go back\"))))));\n  }\n\n}\n\nfunction mapStateToProps(state) {\n  return {\n    courses: state.Course[\"NewCourseList\"],\n    courseCategories: state.Course[\"CourseCategories\"],\n    registrationForm: state.Registration[\"registration_form\"],\n    submitStatus: state.Registration[\"submitStatus\"],\n    parents: state.Users[\"ParentList\"],\n    students: state.Users[\"StudentList\"],\n    instructors: state.Users[\"InstructorList\"]\n  };\n}\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    registrationActions: bindActionCreators(registrationActions, dispatch)\n  };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Form);","map":{"version":3,"sources":["/Users/danielhuang/Desktop/front-end/omou-frontend/src/components/Form/Form.js"],"names":["connect","bindActionCreators","registrationActions","React","Component","Prompt","NavLink","Grid","Button","Paper","Typography","Stepper","Step","StepLabel","StepContent","TextField","InputValidation","Select","InputLabel","FormControl","MenuItem","Fab","AddIcon","RemoveIcon","SearchSelect","BackButton","Modal","Dialog","DialogActions","DialogContent","DialogContentText","DialogTitle","parseGender","Form","constructor","props","onBack","sessionStorage","removeItem","resetSubmitStatus","state","conditional","nextSection","activeStep","activeSection","form","submitPending","preLoaded","existingUser","componentWillMount","prevState","JSON","parse","getItem","formType","computedMatch","params","type","edit","student","students","id","parent","parents","parent_id","first_name","last_name","gender","grade","age","school","email","phone_number","value","user_id","label","name","address","city","zipcode","relationship","instructor","instructors","birth_date","console","warn","registrationForm","setState","oldState","formContents","stringify","NewState","section_titles","course","decodeURIComponent","Object","keys","courses","find","courseID","title","course_id","forEach","Array","isArray","field","options","validateSection","getFormObject","getActiveSection","section","getStepContent","step","currSectionTitle","filter","required","every","values","valid","getConditionalFieldFromCurrentSection","nextSectionInput","some","handleNext","validateField","length","submitForm","conditionalField","nextActiveStep","nextActiveSection","newState","handleBack","handleReset","handleFieldUpdate","sectionTitle","fieldValue","isValid","parseInt","emails","map","includes","setItem","onSelectChange","OldState","selectedParentID","key","removeDuplicates","arr1","arr2","stringValue","stringOtherValue","otherValue","j","uniqueVals","Set","indexOfString","i","splice","renderField","fieldIndex","fieldTitle","target","option","courseList","capacity","filled","fieldCount","reduce","total","width","event","preventDefault","removeField","forceUpdate","studentList","studentCount","instructorList","currParentList","multiline","full","e","bind","addField","currentForm","param","numSameTypeFields","count","otherField","currentSectionFields","currentSectionValidationFields","baseName","newSectionFields","newSectionValidationFields","index","hasNotRemoved","entries","origFieldKey","newFieldName","renderForm","steps","hasOwnProperty","reversedSection","reverse","lastFieldOfType","field_limit","renderSubmitted","margin","padding","fontSize","fieldVal","renderTitle","render","submitStatus","mapStateToProps","Course","courseCategories","Registration","Users","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import {connect} from \"react-redux\";\nimport {bindActionCreators} from \"redux\";\nimport * as registrationActions from \"../../actions/registrationActions\";\nimport React, {Component} from \"react\";\nimport {Prompt} from \"react-router\";\nimport {NavLink} from \"react-router-dom\";\n\n// Material UI Imports\nimport Grid from \"@material-ui/core/Grid\";\nimport Button from \"@material-ui/core/Button\";\nimport Paper from \"@material-ui/core/Paper\";\nimport {Typography} from \"@material-ui/core\";\nimport Stepper from \"@material-ui/core/Stepper\";\nimport Step from \"@material-ui/core/Step\";\nimport StepLabel from \"@material-ui/core/StepLabel\";\nimport StepContent from \"@material-ui/core/StepContent\";\nimport TextField from \"@material-ui/core/TextField\";\nimport {InputValidation} from \"../FeatureViews/Registration/Validations\";\nimport Select from \"@material-ui/core/Select\";\nimport InputLabel from \"@material-ui/core/InputLabel\";\nimport FormControl from \"@material-ui/core/FormControl\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport Fab from \"@material-ui/core/Fab\";\nimport AddIcon from \"@material-ui/icons/Add\";\nimport RemoveIcon from \"@material-ui/icons/Clear\";\n\n// Outside React Component\nimport SearchSelect from \"react-select\";\nimport BackButton from \"../BackButton.js\";\nimport Modal from \"@material-ui/core/Modal\";\n\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogActions from \"@material-ui/core/DialogActions\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport DialogContentText from \"@material-ui/core/DialogContentText\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\n\nconst parseGender = {\n    \"M\": \"Male\",\n    \"F\": \"Female\",\n    \"U\": \"Do not disclose\",\n};\n\nclass Form extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            conditional: \"\",\n            nextSection: false,\n            activeStep: 0,\n            activeSection: \"\",\n            form: \"\",\n            submitPending: false,\n            preLoaded: false,\n            existingUser: false,\n        };\n    }\n\n    componentWillMount() {\n        let prevState = JSON.parse(sessionStorage.getItem(\"form\") || null);\n        const formType = this.props.computedMatch.params.type;\n        if (this.props.computedMatch.params.edit === \"edit\") {\n            switch (formType) {\n                case \"student\": {\n                    const student = this.props.students[this.props.computedMatch.params.id];\n                    if (student) {\n                        const parent = this.props.parents[student.parent_id];\n                        prevState = {\n                            ...this.state,\n                            \"Basic Information\": {\n                                \"Student First Name\": student.first_name,\n                                \"Student Last Name\": student.last_name,\n                                \"Gender\": parseGender[student.gender],\n                                \"Grade\": student.grade,\n                                \"Age\": student.age,\n                                \"School\": student.school,\n                                \"Student Email\": student.email,\n                                \"Student Phone Number\": student.phone_number,\n                            },\n                            \"Parent Information\": {\n                                \"Select Parent\": {\n                                    value: parent.user_id,\n                                    label: `${parent.user_id}: ${parent.name} - ${parent.email}`,\n                                },\n                                \"Parent First Name\": parent.first_name,\n                                \"Parent Last Name\": parent.last_name,\n                                \"Gender\": parseGender[parent.gender],\n                                \"Parent Email\": parent.email,\n                                \"Address\": parent.address,\n                                \"City\": parent.city,\n                                \"State\": parent.state,\n                                \"Zip Code\": parent.zipcode,\n                                \"Relationship to Student\": parent.relationship,\n                                \"Phone Number\": parent.phone_number,\n                            },\n                            \"Basic Information_validated\": {\n                                \"Student First Name\": true,\n                                \"Student Last Name\": true,\n                                \"Gender\": true,\n                                \"Grade\": true,\n                                \"Age\": true,\n                                \"School\": true,\n                                \"Student Email\": true,\n                                \"Student Phone Number\": true,\n                            },\n                            \"Parent Information_validated\": {\n                                \"Parent First Name\": true,\n                                \"Parent Last Name\": true,\n                                \"Gender\": true,\n                                \"Parent Email\": true,\n                                \"Address\": true,\n                                \"City\": true,\n                                \"State\": true,\n                                \"Zip Code\": true,\n                                \"Relationship to Student\": true,\n                                \"Phone Number\": true,\n                            },\n                            \"form\": formType,\n                            \"activeSection\": \"Basic Information\",\n                            \"nextSection\": true,\n                            \"preLoaded\": true,\n                        };\n                    }\n                    break;\n                }\n                case \"instructor\": {\n                    const instructor = this.props.instructors[this.props.computedMatch.params.id];\n                    if (instructor) {\n                        prevState = {\n                            ...this.state,\n                            \"Basic Information\": {\n                                \"First Name\": instructor.first_name,\n                                \"Last Name\": instructor.last_name,\n                                \"E-Mail\": instructor.email,\n                                \"Phone Number\": instructor.phone_number,\n                                \"Gender\": parseGender[instructor.gender],\n                                \"Address\": instructor.address,\n                                \"City\": instructor.city,\n                                \"Zip Code\": instructor.zipcode,\n                                \"State\": instructor.state,\n                                \"Date of Birth\": instructor.birth_date,\n                            },\n                            \"Education\": {\n                                \"College\": \"\",\n                                \"Degree(s)\": \"\",\n                                \"Minor(s)\": \"\",\n                            },\n                            \"Experience\": {\n                                \"Subject(s) Tutor Can Teach\": \"\",\n                                \"Specialties\": \"\",\n                                \"Background\": \"\",\n                                \"Notes\": \"\",\n                            },\n                            \"Basic Information_validated\": {\n                                \"First Name\": true,\n                                \"Last Name\": true,\n                                \"E-Mail\": true,\n                                \"Phone Number\": true,\n                                \"Gender\": true,\n                                \"Address\": true,\n                                \"City\": true,\n                                \"Zip Code\": true,\n                                \"State\": true,\n                                \"Date of Birth\": true,\n                            },\n                            \"Education_validated\": {\n                                \"College\": true,\n                                \"Degree(s)\": true,\n                                \"Minor(s)\": true,\n                            },\n                            \"Experience_validated\": {\n                                \"Subject(s) Tutor Can Teach\": true,\n                                \"Specialties\": true,\n                                \"Background\": true,\n                                \"Notes\": true,\n                            },\n                            \"form\": formType,\n                            \"activeSection\": \"Basic Information\",\n                            \"nextSection\": true,\n                            \"preLoaded\": true,\n                        };\n                    }\n                    break;\n                }\n                default: console.warn(\"Invalid form type!\");\n            }\n        }\n        if (!prevState || formType !== prevState.form || prevState[\"submitPending\"] || (this.props.computedMatch.params.id && this.props.computedMatch.params.edit !== \"edit\")) {\n            if (this.props.registrationForm[formType]) {\n                this.setState((oldState) => {\n                    const formContents = JSON.parse(JSON.stringify(this.props.registrationForm[formType]));\n                    let NewState = {\n                        ...oldState,\n                        activeSection: formContents.section_titles[0],\n                        form: formType,\n                    };\n\n                    let course = \"\";\n                    if (this.props.computedMatch.params.id) {\n                        course = decodeURIComponent(this.props.computedMatch.params.id);\n                        course = Object.keys(this.props.courses).find((courseID) => this.props.courses[courseID].title === course);\n                        course = this.props.courses[course];\n                        if (course) {\n                            // convert it to a format that onselectChange can use\n                            course = {\n                                value: `${course.course_id}: ${course.title}`,\n                                label: `${course.course_id}: ${course.title}`,\n                            };\n                        }\n                    }\n                    formContents.section_titles.forEach((title) => {\n                        // create blank fields based on form type\n                        NewState[title] = {};\n                        // set a value for every non-conditional field (object)\n                        if (Array.isArray(formContents[title])) {\n                            formContents[title].forEach(({field, type, options}) => {\n                                switch (type) {\n                                    case \"course\":\n                                        NewState[title][field] = course;\n                                        break;\n                                    case \"select\":\n                                        NewState[title][field] = options[0];\n                                        break;\n                                    case \"student\":\n                                        NewState[title][field] = \"\";\n                                        break;\n                                    default:\n                                        NewState[title][field] = null;\n                                }\n                            });\n                        }\n                        // create validated state for each field\n                        NewState[`${title}_validated`] = {};\n                        if (Array.isArray(formContents[title])) {\n                            formContents[title].forEach((field) => {\n                                NewState[`${title}_validated`][field.name] = true;\n                            });\n                        }\n                    });\n                    return NewState;\n                }, () => {\n                    this.setState({\n                        nextSection: this.validateSection(),\n                    });\n                });\n            }\n        } else if (prevState && !prevState[\"submitPending\"]) {\n            this.setState(prevState);\n        }\n    }\n\n    getFormObject() {\n        return this.props.registrationForm[this.state.form];\n    }\n\n    getActiveSection() {\n        const section = this.getFormObject()[this.state.activeSection];\n        if (Array.isArray(section)) {\n            return section;\n        } else {\n            return section[this.state.conditional];\n        }\n    }\n\n    onBack = () => {\n        // clear session storage\n        sessionStorage.removeItem(\"form\");\n        this.props.registrationActions.resetSubmitStatus();\n    }\n\n    getStepContent(step, formType) {\n        return this.props.registrationForm[formType][step];\n    }\n\n    validateSection() {\n        const currSectionTitle = this.getFormObject().section_titles[this.state.activeStep];\n        return (\n            this.getActiveSection()\n                .filter(({required}) => required)\n                .every(({name}) => this.state[currSectionTitle][name]) &&\n            Object.values(this.state[`${currSectionTitle}_validated`])\n                .every((valid) => valid)\n        );\n    }\n\n    getConditionalFieldFromCurrentSection() {\n        let nextSectionInput = false;\n        const currSectionTitle = this.state.activeSection;\n        // Get input from the conditional field\n        if (Array.isArray(this.getFormObject()[currSectionTitle])) {\n            this.getFormObject()[currSectionTitle].some((field) => {\n                if (field.conditional) {\n                    nextSectionInput = this.state[currSectionTitle][field.name];\n                    return true;\n                } else {\n                    return false;\n                }\n            });\n        }\n        return nextSectionInput;\n    }\n\n    // Progresses to next section in registration form\n    handleNext() {\n        const currSectionTitle = this.getFormObject().section_titles[this.state.activeStep];\n        let section = this.props.registrationForm[this.state.form][this.state.activeSection];\n        if (!Array.isArray(section)) {\n            section = section[this.state.conditional];\n        }\n        section.forEach((field) => {\n            this.validateField(currSectionTitle, field, this.state[currSectionTitle][field.name]);\n        });\n        this.setState((oldState) => {\n            if (this.validateSection()) {\n                if (oldState.activeStep === this.getFormObject().section_titles.length - 1) {\n                    if (!oldState.submitPending) {\n                        if (this.props.computedMatch.params.edit === \"edit\") {\n                            this.props.registrationActions.submitForm(this.state,\n                                this.props.computedMatch.params.id);\n                        } else {\n                            this.props.registrationActions.submitForm(this.state);\n                        }\n                    }\n                    return {\n                        submitPending: true,\n                    };\n                } else {\n                    const conditionalField = this.getConditionalFieldFromCurrentSection(),\n                        nextActiveStep = oldState.activeStep + 1,\n                        nextActiveSection = this.getFormObject().section_titles[nextActiveStep];\n                    let newState = {\n                        activeStep: nextActiveStep,\n                        activeSection: nextActiveSection,\n                        conditional: conditionalField ? conditionalField : oldState.conditional,\n                        nextSection: false,\n                    };\n                    if (conditionalField) {\n                        let formContents = this.getFormObject(),\n                            title = nextActiveSection;\n                        // create blank fields based on form type\n                        newState[title] = {};\n                        formContents[nextActiveSection][conditionalField].forEach((field) => {\n                            newState[title][field.name] = \"\";\n                        });\n                        // create validated state for each field\n                        newState[`${title}_validated`] = {};\n                        formContents[nextActiveSection][conditionalField].forEach((field) => {\n                            newState[`${title}_validated`][field.name] = true;\n                        });\n                    }\n                    return newState;\n                }\n            } else {\n                return {};\n            }\n        }, () => {\n            this.setState({\n                nextSection: this.validateSection(),\n            });\n        });\n    }\n\n    // Regresses to previous section in registration form\n    handleBack() {\n        this.setState((oldState) => {\n            if (oldState.activeStep !== 0 && oldState.activeSection) {\n                return {\n                    activeStep: oldState.activeStep - 1,\n                    activeSection: this.getFormObject().section_titles[oldState.activeStep - 1],\n                };\n            } else {\n                return {};\n            }\n        }, () => {\n            this.setState({\n                nextSection: this.validateSection(),\n            });\n        });\n    }\n\n    handleReset() {\n        this.setState({activeStep: 0});\n    }\n\n    handleFieldUpdate(sectionTitle, field, fieldValue) {\n        this.setState((oldState) => {\n            oldState[sectionTitle][field.name] = fieldValue;\n            return oldState;\n        });\n    }\n\n    validateField(sectionTitle, field, fieldValue) {\n        this.setState((oldState) => {\n            if (!fieldValue) { // if empty field\n                oldState[`${sectionTitle}_validated`][field.name] = !field.required;\n            } else if (InputValidation(fieldValue, field.type)) { // if valid input\n                let isValid = true;\n                if (field.type === \"number\") {\n                    // parse if number\n                    oldState[sectionTitle][field.name] = parseInt(fieldValue, 10);\n                } else if (field.type === \"email\") {\n                    let emails = [];\n                    if (field.field === \"Student Email\") {\n                        emails = Object.values(this.props.students).map(({email}) => email);\n                    }\n                    // validate that email doesn't exist in database already\n                    isValid = !emails.includes(fieldValue) || this.state.preLoaded;\n                    if (!isValid) {\n                        oldState.existingUser = true;\n                    }\n                }\n                oldState[`${sectionTitle}_validated`][field.name] = isValid;\n            } else {\n                oldState[`${sectionTitle}_validated`][field.name] = false;\n            }\n            return oldState;\n        }, () => {\n            this.setState({\n                nextSection: this.validateSection(),\n            }, () => {\n                sessionStorage.setItem(\"form\", JSON.stringify(this.state));\n            });\n        });\n    }\n\n    onSelectChange(value, label, field) {\n        if (field.type === \"select parent\") {\n            if (value) {\n                this.setState((OldState) => {\n                    let NewState = OldState;\n                    const selectedParentID = value.value;\n                    const parent = this.props.parents[selectedParentID];\n                    NewState[label] = {\n                        \"Select Parent\": {\n                            value: selectedParentID,\n                            label: `${selectedParentID}: ${parent.name} - ${parent.email}`,\n                        },\n                        \"Parent First Name\": parent.first_name,\n                        \"Parent Last Name\": parent.last_name,\n                        \"Gender\": parent.gender,\n                        \"Parent Email\": parent.email,\n                        \"Address\": parent.address,\n                        \"City\": parent.city,\n                        \"State\": parent.state,\n                        \"Zip Code\": parent.zipcode,\n                        \"Relationship to Student\": parent.relationship,\n                        \"Parent Phone Number\": parent.phone_number,\n                        \"user_id\": selectedParentID,\n                    };\n                    Object.keys(NewState[label]).forEach((key) => {\n                        NewState[`${label}_validated`][key] = true;\n                    });\n                    return NewState;\n                }, () => {\n                    this.validateSection();\n                    this.setState({nextSection: true});\n                });\n            } else {\n                this.setState((OldState) => {\n                    let NewState = OldState;\n                    NewState[label] = {\n                        \"Select Parent\": null,\n                        \"Parent First Name\": \"\",\n                        \"Parent Last Name\": \"\",\n                        \"Gender\": \"\",\n                        \"Parent Email\": \"\",\n                        \"Address\": \"\",\n                        \"City\": \"\",\n                        \"State\": \"\",\n                        \"Zip Code\": \"\",\n                        \"Relationship to Student\": \"\",\n                        \"Parent Phone Number\": \"\",\n                        \"user_id\": \"\",\n                    };\n                    Object.keys(NewState[label]).forEach((key) => {\n                        NewState[`${label}_validated`][key] = true;\n                    });\n                    NewState.nextSection = false;\n                    return NewState;\n                });\n            }\n        } else {\n            this.setState((OldState) => {\n                let NewState = OldState;\n                NewState[label][field.name] = value;\n                return NewState;\n            }, () => {\n                this.validateField(this.state.activeSection, field, value);\n            });\n        }\n    }\n\n    // removes duplicates with arr1 from arr2 from search select field\n    removeDuplicates(arr1, arr2) {\n        let stringValue, stringOtherValue;\n        arr1.forEach((value) => {\n            if (value) {\n                stringValue = value.value;\n            } else {\n                stringValue = \"\";\n            }\n            arr2.forEach((otherValue, j) => {\n                if (otherValue) {\n                    stringOtherValue = otherValue.value;\n                } else {\n                    stringOtherValue = \"\";\n                }\n                if (stringValue === stringOtherValue) {\n                    arr2[j] = \"1\";\n                }\n            });\n        });\n        let uniqueVals = [...new Set(arr2)], indexOfString = -1;\n        uniqueVals.forEach((value, i) => {\n            if (typeof value === \"string\") {\n                indexOfString = i;\n            }\n        });\n        if (indexOfString > -1) {\n            uniqueVals.splice(indexOfString, 1);\n        }\n        return uniqueVals;\n    }\n\n    renderField(field, label, fieldIndex) {\n        let fieldTitle = field.name;\n        switch (field.type) {\n            case \"select\":\n                return <FormControl className={\"form-control\"}>\n                    <InputLabel htmlFor={fieldTitle}>{fieldTitle}</InputLabel>\n                    <Select\n                        displayEmpty={false}\n                        value={this.state[label][fieldTitle]}\n                        onChange={({target}) => {\n                            this.onSelectChange(target.value, label, field);\n                        }}>\n                        {\n                            field.options.map((option) => {\n                                return <MenuItem value={option} key={option}>\n                                    <em>{option}</em>\n                                </MenuItem>\n                            }\n\n                            )\n                        }\n                    </Select>\n                </FormControl>;\n            case \"course\": {\n                let courseList = Object.keys(this.props.courses)\n                    .filter((courseID) => this.props.courses[courseID].capacity > this.props.courses[courseID].filled)\n                    .map((courseID) => ({\n                        value: courseID,\n                        label: `${courseID}: ${this.props.courses[courseID].title}`,\n                    }));\n                // remove preselected courses\n                courseList = this.removeDuplicates(Object.values(this.state[label]), courseList);\n                // count # of course fields in current section\n                const fieldCount = this.getActiveSection()\n                    .reduce((total, {type}) => total + (type === \"course\"), 0);\n                return (\n                    <div style={{width: \"inherit\"}}>\n                        <Grid container className={\"student-align\"} spacing={2000}>\n                            <SearchSelect\n                                value={this.state[label][fieldTitle]}\n                                onChange={(value) => {\n                                    this.onSelectChange(value, label, field);\n                                }}\n                                options={courseList}\n                                className=\"search-options\" />\n                            {\n                                (fieldCount > 1) &&\n                                <RemoveIcon color=\"primary\" aria-label=\"Add\" variant=\"extended\"\n                                    className=\"button-remove-student\"\n                                    onClick={(event) => {\n                                        event.preventDefault();\n                                        // deletes answer field from state\n                                        this.removeField(fieldIndex);\n                                        this.forceUpdate();\n                                    }}>\n                                </RemoveIcon>\n                            }\n                        </Grid>\n                    </div>\n                );\n            }\n            case \"student\": {\n                let studentList = Object.values(this.props.students)\n                    .map(({user_id, name, email}) => ({\n                        value: user_id,\n                        label: `${name} - ${email}`,\n                    }));\n\n                studentList = this.removeDuplicates(Object.values(this.state[label]), studentList);\n\n                // count # of course fields in current section\n                const studentCount = this.getActiveSection()\n                    .reduce((total, {type}) => total + (type === \"student\"), 0);\n\n                return (\n                    <div style={{width: \"inherit\"}}>\n                        <Grid container className={\"student-align\"} spacing={2000}>\n                            <SearchSelect\n                                value={this.state[label][fieldTitle] ? this.state[label][fieldTitle] : \"\"}\n                                onChange={(value) => {\n                                    this.onSelectChange(value, label, field);\n                                }}\n                                options={studentList}\n                                className=\"search-options\" />\n                            {\n                                studentCount > 1 &&\n                                <RemoveIcon color=\"primary\" aria-label=\"Add\" variant=\"extended\"\n                                    className=\"button-remove-student\"\n                                    onClick={(event) => {\n                                        event.preventDefault();\n                                        // deletes answer field\n                                        this.removeField(fieldIndex);\n                                        this.forceUpdate();\n                                    }}>\n                                </RemoveIcon>\n                            }\n                        </Grid>\n                    </div>\n                );\n            }\n            case \"instructor\": {\n                let instructorList = this.props.instructors;\n\n                instructorList = Object.values(instructorList).map(({user_id, name, email}) => ({\n                    value: user_id,\n                    label: `${name} - ${email}`,\n                }));\n                instructorList = this.removeDuplicates(Object.values(this.state[label]), instructorList);\n                return (<div style={{width: \"inherit\"}}>\n                    <Grid container className=\"student-align\" spacing={2000}>\n                        <SearchSelect\n                            value={this.state[label][fieldTitle] ? this.state[label][fieldTitle] : \"\"}\n                            onChange={(value) => {\n                                this.onSelectChange(value, label, field);\n                            }}\n                            options={instructorList}\n                            className=\"search-options\" />\n                    </Grid>\n                </div>);\n            }\n            case \"select parent\": {\n                const currParentList = Object.values(this.props.parents)\n                    .map(({user_id, name, email}) => ({\n                        value: user_id,\n                        label: `${name} - ${email}`,\n                    }));\n                return (\n                    <SearchSelect\n                        className=\"search-options\"\n                        isClearable\n                        onChange={(value) => {\n                            this.onSelectChange(value, label, field);\n                        }}\n                        value={this.state[label][fieldTitle]}\n                        options={currParentList}\n                    />\n                );\n            }\n            default:\n                return <TextField\n                    label={field.name}\n                    multiline={field.multiline}\n                    margin=\"normal\"\n                    value={this.state[label][field.name]}\n                    error={!this.state[label + \"_validated\"][field.name]}\n                    helperText={!this.state[label + \"_validated\"][field.name] ? field.name + \" invalid\" : \"\"}\n                    type={field.type === \"number\" ? \"Number\" : \"text\"}\n                    required={field.required}\n                    fullWidth={field.full}\n                    onChange={(e) => {\n                        e.preventDefault();\n                        this.handleFieldUpdate.bind(this)(label, field, e.target.value);\n                    }}\n                    onBlur={(e) => {\n                        e.preventDefault();\n                        this.validateField.bind(this)(label, field, e.target.value);\n                    }}\n                />\n        }\n    }\n\n    addField(field, fieldIndex) {\n        const currentForm = this.getFormObject();\n        let param = [this.state.form, this.state.activeSection, fieldIndex];\n        if (!Array.isArray(currentForm[this.state.activeSection])) {\n            param.splice(2, 0, this.state.conditional);\n        }\n        this.props.registrationActions.addField(param);\n        this.setState((prevState) => {\n            // number of fields of the same type as the current field\n            const {form, activeSection, conditional} = prevState;\n            let section = this.props.registrationForm[form][activeSection];\n            if (!Array.isArray(section)) {\n                section = section[conditional];\n            }\n            const numSameTypeFields = section.reduce((count, otherField) =>\n                count + (field === otherField.field), 0);\n            if (Array.isArray(prevState[activeSection])) {\n                prevState[activeSection][`${field} ${numSameTypeFields}`] = null;\n                prevState[`${activeSection}_validated`][`${field} ${numSameTypeFields}`] = true;\n            } else {\n                prevState[activeSection][`${field} ${numSameTypeFields}`] = null;\n                prevState[`${activeSection}_validated`][`${field} ${numSameTypeFields}`] = true;\n            }\n            return prevState;\n        }, () => {\n            sessionStorage.setItem(\"form\", JSON.stringify(this.state));\n        });\n        // for some reason it isn't rerendering automatically\n    }\n\n    removeField(fieldIndex) {\n        this.setState((prevState) => {\n            const currentSectionFields = prevState[prevState[\"activeSection\"]];\n            const currentSectionValidationFields = prevState[`${prevState[\"activeSection\"]}_validated`];\n            let baseName;\n            let newSectionFields = {};\n            let newSectionValidationFields = {};\n            let index = 0;\n            let hasNotRemoved = true;\n\n            Object.entries(currentSectionFields).forEach(([origFieldKey, fieldValue]) => {\n                if (index === 0 && hasNotRemoved) {\n                    baseName = origFieldKey;\n                }\n                if (index === fieldIndex && hasNotRemoved) {\n                    hasNotRemoved = false;\n                    return;\n                }\n                let newFieldName = index === 0 ? baseName : `${baseName} ${index + 1}`;\n                newSectionFields[newFieldName] = fieldValue;\n                newSectionValidationFields[newFieldName] = currentSectionValidationFields[origFieldKey];\n                index++;\n            });\n\n            prevState[prevState[\"activeSection\"]] = newSectionFields;\n            prevState[`${prevState[\"activeSection\"]}_validated`] = newSectionValidationFields;\n            //save to session Storage\n            sessionStorage.setItem(\"form\", JSON.stringify(this.state));\n            return prevState;\n        }, () => {\n            //delete field from redux store\n            let param = [this.state.form, this.state.activeSection];\n            this.props.registrationActions.removeField(param, fieldIndex, this.state.conditional);\n            this.forceUpdate();\n        });\n        this.forceUpdate();\n    }\n\n    renderForm() {\n        let {activeStep, nextSection} = this.state,\n            currentForm = this.props.registrationForm[this.state.form],\n            steps = currentForm.section_titles;\n        let section = this.getActiveSection();\n        return (\n            <Stepper\n                activeStep={activeStep}\n                orientation=\"vertical\"\n                className=\"form-section\">\n                {\n                    steps.map((label, i) => (\n                        <Step key={label}>\n                            <StepLabel>\n                                {label}\n                                {activeStep > i &&\n                                    Object.entries(this.state[label]).map(([field, value]) => {\n                                        if (!value) {\n                                            return null;\n                                        }\n                                        if (value && value.hasOwnProperty(\"label\")) {\n                                            value = value.label;\n                                        }\n\n                                        return (\n                                            <div key={field}>\n                                                <Typography className=\"field-title\" align=\"left\">\n                                                    {field}: {value}\n                                                </Typography>\n                                            </div>\n                                        );\n                                    })\n                                }\n                            </StepLabel>\n                            <StepContent>\n                                {\n                                    section.map((field, j) => {\n                                        // number of fields of the same type as the current field\n                                        const numSameTypeFields = section.reduce((count, otherField) => field.field === otherField.field ? count + 1 : count, 0),\n                                            reversedSection = [...section].reverse(),\n                                            lastFieldOfType = reversedSection.find((otherField) => otherField.field === field.field);\n                                        return (\n                                            <div key={j} className=\"fields-wrapper\" style={{}}>\n                                                <Grid container className=\"student-align\">\n                                                    {label === this.state.activeSection ? this.renderField(field, label, j) : \"\"}\n                                                </Grid>\n                                                <br />\n                                                {\n                                                    !this.props.computedMatch.params.course && numSameTypeFields < field.field_limit &&\n                                                    field === lastFieldOfType &&\n                                                    <Fab color=\"primary\" aria-label=\"Add\" variant=\"extended\"\n                                                        className=\"button add-student\"\n                                                        onClick={(event) => {\n                                                            event.preventDefault();\n                                                            this.addField(field.field, j);\n                                                        }}>\n                                                        <AddIcon />\n                                                        Add {field.field}\n                                                    </Fab>\n                                                }\n\n                                            </div>\n                                        );\n                                    })\n                                }\n                                <div className=\"controls\">\n                                    <Button\n                                        disabled={activeStep === 0}\n                                        color=\"secondary\"\n                                        onClick={(event) => {\n                                            event.preventDefault();\n                                            this.handleBack();\n                                        }}\n                                        className={`button ${activeStep === 0 ? \"hide\" : \"\"}`}>\n                                        Back\n                                    </Button>\n                                    <Button\n                                        variant=\"contained\"\n                                        color=\"primary\"\n                                        disabled={!nextSection}\n                                        onClick={(event) => {\n                                            event.preventDefault();\n                                            this.handleNext();\n                                        }}\n                                        className=\"button primary\">\n                                        {activeStep === steps.length - 1 ? this.props.submitPending ? \"Submitting\" : \"Submit\" : \"Next\"}\n                                    </Button>\n                                </div>\n                            </StepContent>\n                        </Step>\n                    ))\n                }\n            </Stepper>\n        );\n    }\n\n    // view after a submitted form\n    renderSubmitted() {\n        const currentForm = this.props.registrationForm[this.state.form];\n        const steps = currentForm.section_titles;\n        sessionStorage.removeItem(\"form\");\n        return (\n            <div style={{\n                margin: \"2%\",\n                padding: \"5px\",\n            }}>\n                <Typography align=\"left\" style={{fontSize: \"24px\"}}>\n                    You have successfully registered!\n                </Typography>\n                <Typography align=\"left\" style={{fontSize: \"14px\"}}>\n                    An email will be sent to you to confirm your registration\n                </Typography>\n                <Button\n                    align=\"left\"\n                    component={NavLink}\n                    to=\"/registration\"\n                    onClick={() => {\n                        this.props.registrationActions.resetSubmitStatus();\n                    }}\n                    style={{margin: \"20px\"}}\n                    className=\"button\">Back to Registration</Button>\n                <div className=\"confirmation-copy\">\n                    <Typography className=\"title\" align=\"left\">Confirmation Copy</Typography>\n                    {\n                        steps.map((sectionTitle) => (\n                            <div key={sectionTitle}>\n                                <Typography\n                                    className=\"section-title\"\n                                    align=\"left\">\n                                    {sectionTitle}\n                                </Typography>\n                                {\n                                    this.getActiveSection().map(({field, type}) => {\n                                        let fieldVal = this.state[sectionTitle][field];\n                                        if (fieldVal && fieldVal.hasOwnProperty(\"value\")) {\n                                            fieldVal = fieldVal.value;\n                                            if (type === \"select parent\" && typeof fieldVal === \"number\") {\n                                                fieldVal = this.props.parents[fieldVal].first_name;\n                                            }\n                                        }\n\n                                        return (\n                                            <div key={field}>\n                                                <Typography className=\"field-title\" align=\"left\">\n                                                    {field || \"\"}\n                                                </Typography>\n                                                <Typography className=\"field-value\" align=\"left\">\n                                                    {fieldVal || \"N/A\"}\n                                                </Typography>\n                                            </div>\n                                        );\n                                    })\n                                }\n                            </div>\n                        ))\n                    }\n                </div>\n            </div>\n        );\n    }\n\n    renderTitle(id, type) {\n        switch (type) {\n            case \"course\":\n                return id ? decodeURIComponent(id) : \"\";\n            case \"student\": {\n                const student = this.props.students[id];\n                return student ? student.name : \"\";\n            }\n            default:\n                return \"\";\n        }\n    }\n\n    render() {\n        return (\n            <Grid container className=\"\">\n                {/* Determine if finished component is displayed. If not, then don't prompt */}\n                {this.state.submitPending ? \"\" : <Prompt message=\"Are you sure you want to leave?\" />}\n                <Grid item xs={12}>\n                    <Paper className={\"registration-form paper\"}>\n                        <BackButton\n                            warn={true}\n                            onBack={this.onBack}\n                            alertMessage={\"Do you want to save your changes?\"}\n                            alertConfirmText={\"Yes, save changes\"}\n                            confirmAction={\"saveForm\"}\n                            alertDenyText={\"No, don't save changes\"}\n                            denyAction={\"default\"}\n                        />\n                        <Typography className=\"heading\" align=\"left\">\n                            {this.renderTitle(this.props.computedMatch.params.id, this.state.form)} {this.props.computedMatch.params.type} Registration\n                        </Typography>\n                        {\n                            this.props.submitStatus !== \"success\" ?\n                                this.props.registrationForm[this.state.form] ?\n                                    this.renderForm.bind(this)() :\n                                    <Typography>\n                                        Sorry! The form is unavailable.\n                                    </Typography>\n                                : this.renderSubmitted()\n                        }\n                        <Modal\n                            aria-labelledby=\"simple-modal-title\"\n                            aria-describedby=\"simple-modal-description\"\n                            open={this.state.existingUser}\n                            onClick={(e) => {\n                                e.preventDefault();\n                                this.setState({existingUser: false})\n                            }}>\n                            <div className=\"existing-user-popup\">\n                                <Typography variant=\"h6\" id=\"modal-title\">\n                                    {\"The user you are entering already exists in the database! Please enter a new email, and check for spelling.\"}\n                                </Typography>\n                                <Button\n                                    onClick={(e) => {\n                                        e.preventDefault();\n                                        this.setState({existingUser: false})\n                                    }}\n                                    color=\"primary\"\n                                    className=\"button primary\">\n                                    {\"I will enter a new email\"}\n                                </Button>\n                            </div>\n                        </Modal>\n                        {/* Error message on failed submit */}\n                        <Dialog\n                            open={this.props.submitStatus === \"fail\"}\n                            onClose={() => {\n                                this.props.registrationActions.resetSubmitStatus();\n                                this.setState({\n                                    \"submitPending\": false,\n                                }, () => {\n                                    sessionStorage.setItem(\"form\", JSON.stringify(this.state));\n                                });\n                            }}\n                            aria-labelledby=\"alert-dialog-title\"\n                            aria-describedby=\"alert-dialog-description\">\n                            <DialogTitle id=\"alert-dialog-title\">Failed to Submit</DialogTitle>\n                            <DialogContent>\n                                <DialogContentText id=\"alert-dialog-description\">\n                                    There was an error submitting the form. Check all fields and try again.\n                                </DialogContentText>\n                            </DialogContent>\n                            <DialogActions>\n                                <Button onClick={() => {\n                                    this.props.registrationActions.resetSubmitStatus();\n                                    this.setState({\n                                        \"submitPending\": false,\n                                    }, () => {\n                                        sessionStorage.setItem(\"form\", JSON.stringify(this.state));\n                                    });\n                                }} color=\"primary\" autoFocus>\n                                    Go back\n                                </Button>\n                            </DialogActions>\n                        </Dialog>\n                    </Paper>\n                </Grid>\n            </Grid>\n        );\n    }\n}\n\nfunction mapStateToProps(state) {\n    return {\n        courses: state.Course[\"NewCourseList\"],\n        courseCategories: state.Course[\"CourseCategories\"],\n        registrationForm: state.Registration[\"registration_form\"],\n        submitStatus: state.Registration[\"submitStatus\"],\n        parents: state.Users[\"ParentList\"],\n        students: state.Users[\"StudentList\"],\n        instructors: state.Users[\"InstructorList\"],\n    };\n}\n\nfunction mapDispatchToProps(dispatch) {\n    return {\n        registrationActions: bindActionCreators(registrationActions, dispatch),\n    };\n}\n\nexport default connect(\n    mapStateToProps,\n    mapDispatchToProps,\n)(Form);\n"]},"metadata":{},"sourceType":"module"}